---
title: Bandwith, coverage, monitoring and other types of Voodoo
date: 2017-04-13 13:37 UTC
author: stb
tags:
---

As a Sysadmin at Panter you’re also responsible for the Infrastructure of Impact
Hub Zürich a vibrant coworkingspace in the heart of zürich. On 3 floors and a
total of roughly 2000 square meters, we’re making sure that all the members fit into our WiFi
network, as always in such a crowded place there’s not much margin for errors.
And because our Frequencies are almost as crowded with rogue WiFis like the death
star’s having holes for thermonuclear missiles, this can be quite challenging and
sometimes quite frustrating.

[![Youtube:Steve Jobs 500 WiFi Basestations](jobs.jpg)]
(https://youtu.be/1-oIL9cLHDc?t=19 "Steve Jobs WiFi")

In this Blog post we'd like to give you a little bit of insight into our Configuration
and how we're troubleshooting our Network. Our WiFi runs exclusively on Mikrotik
devices because this gives us a lot of flexibility, their devices come at a fair
price and we're not forced to pay fees to use their products.
When we first got here we had nothing but an empty Rack, an old DIY Router and
some broken cables, step by step we've built up the infrastructure adjusting it to our needs.

## The dawn of WiFi
![Shabby AP](ShabbyAP.jpg)

We started with an emergency setup (2 access points) because we had to move on
faster than expected, there was not much of a concept, but it worked for us Panters
which were pretty much alone at that time. While we were having our office on a
construction site which was quite dusty at the time, we even managed to nearly
kill our Router because he suffocated in the dust (the whole rack was accidentally
covered in dust) but it was nothing a little bit of compressed air couldn't solve.

![Bunch of Cables](CableBunch.jpg)

Now working on a construction site has its downsides, but it also gives you the
freedom to plan your LAN outlets and whatnot, or so we thought, but everything got built quite
differently as planned so those outlets are still a vision. We had to reverse engineer
every single one of a bunch of cables because documentation of the existing Network was nonexistent.

When we moved here, our Rack was neat and clean and there were almost no cables,
we also had to install the cables by ourselves because our top floor was a dusty
attic which looked like it hasn't been touched for the last half of the decade
it didn't have any cabling at all. Since then all visible and non-visible LAN
outlets were patched and if you spot an outlet at our Colab feel free to use it.

![Before and after](beforeAfter.jpg)

With the help of our Network crack (koa) we've got a solid setup and started to
use Mikrotiks Capsman, which is a bit of a pain to get into but it works like a
charm after the initial Setup (and 10 Factory Resets later) and a little bit of
a hassle to wrap your head around it.

## Perception
There's always a gap between sysadmins and users when it comes to quality, we're
pretty much the only fans of cabled connection and we love the convenience of cables
and because we had a lot of LAN Ports in this building where a school was located
back in the day, we had this sweet vision of small AP & Switch combos on every
table so people who preferred WiFi could get it from the ether and the other
half could use cables as they desire, but well, that idea got chased out of town
pretty fast (Except the [makerZspace](https://makerzspace.ch/) they love cables and got them).

So we decided to aim for total 5g coverage and slowly starve out 2.4g, because it's
way faster and it allows you to put up a higher density of AP's and if less people use
one access point everyone will have a faster connection, and since we where living in
the year 2015 where every device is capable of 5g there shouldn't be an issue with
partially dropping 2.4g, right? **TOTALLY WRONG**

![ClientBandDistribution](ClientBandDistribution.jpg)

As it turns out the 5g capable devices aren't consistently great with 5g connectivity,
most of those devices only support the lower bands 5-036 & 5-044 and hollow glass
bricks are apparently the death of every 5g connection, there are also quite some
differences between mikrotiks different products, here's a list of a few of which
we went through and the ones we're currently using.

### Legacy AP's
* [Netmetal](https://routerboard.com/RB922UAGS-5HPacT-NM) - Alot of DIY, so it's
time consuming and thus not quite cheap, but nearly indestructible and perfect
for outdoors
* [Netbox](https://routerboard.com/RB911G-5HPacD-NB) - Also DIY, pretty huge and
not quite cheap, also not the most aesthetic ones
* [cAP2n](https://routerboard.com/RBcAP2nD) - Plastic toy, wouldn't recommend

### Current AP's
* [wAP](https://routerboard.com/RBwAPG-5HacT2HnD) - Aesthetic pretty good
dualband accesspoints with a good range
* [SXT SA5 ac](https://routerboard.com/RBSXTG-5HPacD-SA) - With an angle of 90°
perfect for the corners in our CoWorking Space
* [wAP ac](https://routerboard.com/RBwAPG-5HacT2HnD) - very fast, performant AP
* [hAP ac](https://routerboard.com/RB962UiGS-5HacT2HnT) - like the wAP ac but with
a built in switch

We were also pretty harsh when it comes down to kicking people out of our Accesspoints,
because if you got a bad connection you're giving a bad time to all the other people
using that access point. When we lowered the connectivity threshold to our sweet spot
of 65dBm we had an awesome connection, but somehow all the other users were having a
bad time, this is the point you have to realize that you obviously have another perception
of "things going well" (although you're right). At the moment we're having 20 AP's on 3
Floors, serving over 300 clients during peak hours.

![ClientsPerAP](ClientsPerAP.jpg)

With all those different devices and total freedom for our coworkers there are
always some people having connectivity issues nonetheless, so the bigger we get,
the more important is that we know how to Monitor our Network and how to distribute
the load that's hammering on our infrastructure.

![TrafficPerAP](TrafficPerAP.jpg)

## Monitoring
If you're responsible for something which quite a few people rely on every day, you
as a Sysadmin should be able to tell someone where the Problem comes from.
So it's quite important to monitor your radio waves, so you can start investigating
rising issues before a lot of people are affected by it and to troubleshoot specific
clients' issues.

Having some Schools and offices around us, we're sometimes experiencing
a peak in Traffic every time there's a bunch of Schoolboys in front of the Office
watching YouTube and what not over our Free WiFi. Because that free WiFi is actually
intended for the Visitors of the Co-Working Space it's important to drop Clients
that are too far away (across the street inside the school building), that's why
we're constantly monitoring our Frequencies and repositioning our AP's in order
to supply our guests with a good connection (that's also where our fancy graphs come from).

![SignalStats](SignalStats.jpg)

We're also periodically mapping out our space to check for coverage issues,
noise sources, interferences and overlapping channels.

![SignalLevel](SignalLevel.jpg)

We went on to develop our own self service Portal on which you can send us a rating
to our company chat as well as chasing the issue yourself. We're also in the middle
of open sourcing it and as soon as we get there you can use it however you like and
tinker with it, it should work on all CapsMan enabled Mikrotik Networks (Make sure to
 follow us on one of our channels to get the news as soon as it happens).

![Shazaam](Shazaam.jpg)

We've gone so far to even supply our guest with an Intranet Dashboard in which
you can check your WiFi Performance using Prometheus to save the timeseries and
Grafana to visualize them.

![Dashboard](DashboardWifi.jpg)
